import { useState } from "react";
import { DateRange } from "react-date-range";
import AddVulnerabilityBar from "../components/AddVulnerabilityBar";
import VulnerabilityTable from "../components/VulnerabilityTable";


const Sidebar = () => {
  const [dateRetest, setDateRetest] = useState([
    {
      startDate: new Date(),
      endDate: null,
      key: 'retestDateRange'
    }
  ]);
  const [dateAudyt, setDateAudyt] = useState([
    {
      startDate: new Date(),
      endDate: null,
      key: 'audytDateRange'
    }
  ]);
  
  const [vulnerabilities, setVulnerabilities] = useState([]);

  const addVulnerability = (item) => {
    const tempState = [...vulnerabilities];
    tempState.push({ name: item.name, danger: item.danger, done: item.done });
    setVulnerabilities(tempState);
  };

  return (
    <div className="text-center">
      {console.log(dateRetest)}
      {console.log(dateAudyt)}
      <h4 className="text-uppercase fw-bold">Sekcje raportu</h4>
      <hr />

      <div class="accordion accordion-flush" id="accordionFlushExample">
        <div class="accordion-item">
          <h2 class="accordion-header" id="flush-headingOne">
            <button
              class="accordion-button collapsed"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#flush-collapseOne"
              aria-expanded="false"
              aria-controls="flush-collapseOne"
            >
              1. Informacje ogólne
            </button>
          </h2>
          <div
            id="flush-collapseOne"
            class="accordion-collapse collapse"
            aria-labelledby="flush-headingOne"
            data-bs-parent="#accordionFlushExample"
          >
            <div class="accordion-body">
              <form className="row g-3 mt-3">
                <div className="row mb-3 my-2">
                  <label for="system" className="col-sm-4 col-form-label">
                    Testowany system
                  </label>
                  <div className="col-sm-8">
                    <input
                      type="text"
                      className="form-control"
                      id="system"
                    />
                  </div>
                </div>
                <div className="row mb-3 my-2">
                  <label
                    for="miejsce"
                    className="col-sm-4 col-form-label"
                  >
                    Miejsce wykonywania audytu
                  </label>
                  <div className="col-sm-8">
                    <input
                      type="text"
                      className="form-control"
                      id="miejsce"
                    />
                  </div>
                </div>
                <div className="row mb-3 my-2">
                  <label
                    for="audytorzy"
                    className="col-sm-4 col-form-label"
                  >
                    Audytorzy wykonujący prace
                  </label>
                  <div className="col-sm-8">
                    <input
                      type="text"
                      className="form-control"
                      id="audytorzy"
                    />
                  </div>
                </div>
                <div className="row mb-3 my-2">
                  <label
                    for="wersja"
                    className="col-sm-4 col-form-label"
                  >
                    Wersja raportu
                  </label>
                  <div className="col-sm-8">
                    <input
                      type="text"
                      className="form-control"
                      id="wersja"
                    />
                  </div>
                </div>
                <div className="row mb-3 my-2">
                  <div className="col-sm-4"></div>

                  <div className="col-sm-4 form-floating float-center">
                    <p className="text-light text-center">Data wykonania audytów</p>
                    <DateRange
                      onChange={item => setDateAudyt([item.audytDateRange])}
                      editableDateInputs={true}
                      moveRangeOnFirstSelection={false}
                      ranges={dateAudyt}
                      className="rounded-3"
                    />
                  </div>
                  <div className="col-sm-4 form-floating float-center">
                    <p className="text-light text-center">Data wykonania retestów</p>
                    <DateRange
                      onChange={item => setDateRetest([item.retestDateRange])}
                      editableDateInputs={true}
                      moveRangeOnFirstSelection={false}
                      ranges={dateRetest}
                      className="rounded-3"
                    />
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
        <div class="accordion-item">
          <h2 class="accordion-header" id="flush-headingTwo">
            <button
              class="accordion-button collapsed"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#flush-collapseTwo"
              aria-expanded="false"
              aria-controls="flush-collapseTwo"
            >
              2. Podsumowanie testów
            </button>
          </h2>
          <div
            id="flush-collapseTwo"
            class="accordion-collapse collapse"
            aria-labelledby="flush-headingTwo"
            data-bs-parent="#accordionFlushExample"
          >
            <div class="accordion-body">
              <div class="accordion-body">
                <form className="row g-3 mt-3">
                  <div className="row mb-3 my-2">
                    <label
                      for="inputEmail3"
                      className="col-sm-4 col-form-label"
                    >
                      Opis założeń i specyfikacja testu
                    </label>
                    <div className="col-sm-8">
                      <input
                        type="text"
                        className="form-control"
                        id="inputEmail3"
                      />
                    </div>
                  </div>
                  <div className="row mb-3 my-2">
                    <label
                      for="wnioski"
                      className="col-sm-4 col-form-label"
                    >
                      Wnioski płynace z testów
                    </label>
                    <div className="col-sm-8">
                      <input
                        type="text"
                        className="form-control"
                        id="wnioski"
                      />
                    </div>
                  </div>
                  <div className="row mb-3 my-2">
                    <label
                      for="podatności"
                      className="col-sm-4 col-form-label"
                    >
                      Wskazane podatności
                    </label>
                    <div className="col-sm-8">
                      <input
                        type="text"
                        className="form-control"
                        id="podatności"
                      />
                    </div>
                  </div>
                  <div className="row mb-3 my-2">
                    <label
                      for="podsumowanie"
                      className="col-sm-4 col-form-label"
                    >
                      Podsumowanie techniczne
                    </label>
                    <div className="col-sm-8">
                      <input
                        type="text"
                        className="form-control"
                        id="podsumowanie"
                      />
                    </div>
                  </div>
                  <div className="row mb-3 my-2">
                    <label
                      for="inputPassword3"
                      className="col-sm-4 col-form-label"
                    >
                      Zalecenia dalszych zmian
                    </label>
                    <div className="col-sm-8">
                      <input
                        type="text"
                        className="form-control"
                        id="inputPassword3"
                      />
                    </div>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
        <div class="accordion-item">
          <h2 class="accordion-header" id="flush-headingThree">
            <button
              class="accordion-button collapsed"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#flush-collapseThree"
              aria-expanded="false"
              aria-controls="flush-collapseThree"
            >
              3. Wykryte podatności
            </button>
          </h2>
          <div
            id="flush-collapseThree"
            class="accordion-collapse collapse"
            aria-labelledby="flush-headingThree"
            data-bs-parent="#accordionFlushExample"
          >
            <AddVulnerabilityBar submit={addVulnerability} />
            <VulnerabilityTable data={vulnerabilities} />

          </div>
        </div>

        <div class="accordion-item">
          <h2 class="accordion-header" id="flush-headingFour">
            <button
              class="accordion-button collapsed"
              type="button"
              data-bs-toggle="collapse"
              data-bs-target="#flush-collapseFour"
              aria-expanded="false"
              aria-controls="flush-collapseFour"
            >
              4. Szczegóły wykrytych podatności
            </button>
          </h2>
          <div
            id="flush-collapseFour"
            class="accordion-collapse collapse"
            aria-labelledby="flush-headingFour"
            data-bs-parent="#accordionFlushExample"
          >
            <div class="accordion-body">
              {vulnerabilities && vulnerabilities.map((item, index) => {
                return (
                  <>
                    <div class="accordion-item">
                      <h2 class="accordion-header" id={"heading" + index}>
                        <button
                          class="accordion-button"
                          type="button"
                          data-bs-toggle="collapse"
                          data-bs-target={"#collapse" + index}
                          aria-expanded="false"
                          aria-controls={"collapse" + index}
                        >
                          {index+1}. {item.name}
                        </button>
                      </h2>
                      <div
                        id={"collapse" + index}
                        class="accordion-collapse collapse"
                        aria-labelledby={"heading" + index}
                        data-bs-parent={"#accordion" + index}
                      >
                        <div class="accordion-body">
                          <h5>Jakis opis sraka</h5>
                          <input placeholder="input szalala" />
                        </div>
                      </div>
                    </div>
                  </>
                );
              })}
              
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};

export default Sidebar;
